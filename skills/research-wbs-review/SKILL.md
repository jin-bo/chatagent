---
name: research-wbs-review
description: 审核科研项目的WBS（工作分解结构）Excel表格，基于标准化原则提供详细的审核建议。适用于科研项目管理中的WBS质量检查，确保符合分类组合、厘清目标、双方确认、责任匹配四大原则。当用户要求审核WBS文件、检查WBS质量、或提到"WBS审核"、"WBS检查"、"科研项目WBS"时触发。输入为Excel格式的WBS文件（如AI-WBS-部门-日期.xlsx），输出为Markdown格式的审核报告。
---

# 科研WBS审核技能

审核科研项目的WBS Excel表格，基于标准化原则提供专业的审核建议。

## 快速开始

审核WBS文件：

```bash
python scripts/review_wbs.py <WBS文件路径>
```

示例：
```bash
python scripts/review_wbs.py AI-WBS-部门-日期.xlsx
```

输出为Markdown格式的审核报告，包含问题分类、严重程度评级和改进建议。

## 审核标准

本技能基于四大核心原则审核WBS：

### 1. 分类组合原则
- 检查WBE类型是否符合标准（目标、里程碑、正常、风险等级）
- 验证一级WBE是否标记为"目标"类型
- 确保所有类型经组织认可

### 2. 厘清目标原则
- 检查任务描述完整性和清晰度
- 验证一级WBE是否明确标注交付物类型
- 检查关键时间节点（开始/结束日期）

### 3. 双方确认原则
- 验证所有一级WBE是否分配责任单位/团队
- 检查责任边界是否清晰

### 4. 责任匹配原则
- 检查叶子节点是否明确责任人
- 验证责任颗粒度是否合理
- 确保一个WBE仅由一个责任主体承担

### 额外检查项
- **WBS结构完整性**: 编号层级、连续性
- **状态一致性**: 状态值标准化、与日期逻辑一致

## WBS文件格式要求

### 必需的Sheet
- **WBS**: 主要的工作分解结构表
- **Dictionary**: 字段取值字典（可选但建议）

### WBS Sheet结构

标准列（按顺序）：
1. Level - 层级（1/2/3/4...）
2. WBS - WBS编号（1, 1.1, 1.1.1...）
3. Task Description - 任务描述
4. Type - 类型（目标/里程碑/正常/风险等级）
5. Priority - 优先级（高/中/低/待定）
6. Assigned To - 责任人
7. Status - 状态（未分配/未开始/进行中/延误/完成）
8. Start - 开始日期
9. End - 结束日期
10. 今天进展 - 可选
11. 明天计划 - 可选
12. Notes - 备注

### 命名规范

**一级WBE（目标）**:
```
交付物-系统/产品A
交付物-调研报告/市场分析
交付物-数据集/测试集构建
```

**子级WBE**: 清晰描述模块/组件/功能名称

## 审核报告解读

### 报告结构

```markdown
# 科研WBS审核报告

**审核文件**: [文件名]
**WBE总数**: [数量]
**发现问题**: [数量]
- 高严重度: [数量] 个
- 中严重度: [数量] 个
- 低严重度: [数量] 个

## 审核详情

### [原则名称]

#### 🔴/🟡/🟢 行 [行号] - WBS [编号]
**问题**: [问题描述]
**建议**: [改进建议]
```

### 严重程度分级

- **🔴 高**: 违反核心原则，必须修改（如一级WBE无责任人、任务描述缺失）
- **🟡 中**: 影响管理效果，建议修改（如叶子节点无责任人、缺少日期）
- **🟢 低**: 格式或规范性问题，可选修改（如状态值非标准、责任过于集中）

## 详细标准文档

完整的审核标准和最佳实践详见：[references/standards.md](references/standards.md)

包含：
- 四大原则的详细解释和审核要点
- WBS结构完整性要求
- 常见问题与改进建议
- 审核流程建议

## 工作流程

1. **准备**: 确保WBS文件为Excel格式（.xlsx），包含WBS sheet
2. **执行审核**: 运行 `python scripts/review_wbs.py <文件路径>`
3. **查看报告**: 审核报告输出到标准输出（可重定向到文件）
4. **修正问题**: 根据建议修改WBS文件
5. **重新审核**: 修改后再次审核验证

## 技术依赖

- Python 3.7+
- pandas
- openpyxl

安装依赖：
```bash
pip install pandas openpyxl
```

## 示例

### 输入文件示例

文件名：`AI-WBS-部门-日期.xlsx`

WBS Sheet内容：
```
Level | WBS   | Task Description        | Type | Assigned To | Status | Start      | End
1     | 1     | 交付物-系统/产品A         | 目标 | 张三        | 进行中  | 2025-07-15 | 2025-08-15
2     | 1.1   | 模块/组件 1              |      |             | 完成    | 2025-07-15 | 2025-07-20
3     | 1.1.1 | 功能特性 1.1             |      |             | 完成    | 2025-07-15 | 2025-07-18
```

### 常见用法

```bash
# 基本审核
python scripts/review_wbs.py project-wbs.xlsx

# 将报告保存到文件
python scripts/review_wbs.py project-wbs.xlsx > audit-report.md

# 审核多个文件
for file in *.xlsx; do
    python scripts/review_wbs.py "$file" > "${file%.xlsx}-audit.md"
done
```

## 注意事项

- 审核脚本会跳过表格前面的空行和标题行，自动识别数据起始位置
- 如果Dictionary sheet不存在，仍可正常审核，使用内置的标准值
- 对于非标准格式的WBS表格，可能需要调整脚本中的列名映射
- 审核结果仅供参考，最终是否通过应由项目双方协商确定

## 自定义与扩展

如需调整审核规则或添加新的检查项：

1. 编辑 `scripts/review_wbs.py` 中的审核方法
2. 参考现有的 `check_*_principle()` 方法
3. 在 `review()` 方法中调用新的检查方法
4. 更新 `references/standards.md` 文档说明新规则
